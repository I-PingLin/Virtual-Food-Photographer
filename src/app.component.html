<div class="min-h-screen flex flex-col lg:grid lg:grid-cols-12 font-sans">

  <!-- Left Panel: Input -->
  <aside class="lg:col-span-4 xl:col-span-3 bg-gray-900 border-r border-gray-700/50 p-6 lg:p-8 flex flex-col">
    <header class="mb-8">
      <h1 class="text-3xl font-bold text-white tracking-tight">Virtual Food Photographer</h1>
      <p class="text-gray-400 mt-2">Generate stunning, AI-powered photos for your menu in seconds.</p>
    </header>

    <section class="flex-grow flex flex-col">
      <label for="menu-input" class="block text-sm font-medium text-gray-300 mb-2">1. Paste your menu</label>
      <textarea 
        id="menu-input"
        rows="8"
        class="w-full bg-gray-800 border border-gray-700 rounded-lg p-3 text-gray-200 placeholder-gray-500 focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition duration-150"
        placeholder="e.g.,&#10;Classic Burger - Beef patty, cheddar, lettuce, tomato.&#10;Caesar Salad - Romaine lettuce with croutons..."
        [value]="menuText()"
        (input)="handleTextInput($event)"></textarea>

      <fieldset class="mt-8">
        <legend class="block text-sm font-medium text-gray-300 mb-3">2. Choose a style</legend>
        <div class="grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-1 gap-4">
          @for (style of styles; track style.id) {
            <button
              (click)="selectStyle(style.id)"
              [class]="'p-4 rounded-lg border-2 text-left transition duration-200 ' + (selectedStyle() === style.id ? 'bg-indigo-600 border-indigo-500 shadow-lg' : 'bg-gray-800 border-gray-700 hover:border-gray-500')">
              <div class="flex items-center gap-3">
                <span [innerHTML]="style.icon"></span>
                <span class="font-semibold">{{ style.name }}</span>
              </div>
              <p class="text-xs text-gray-400 mt-2">{{ style.description }}</p>
            </button>
          }
        </div>
      </fieldset>

      <div class="mt-auto pt-8">
        <button 
          (click)="generatePhotos()" 
          [disabled]="isLoading() || menuText().trim().length === 0"
          class="w-full flex items-center justify-center gap-3 bg-indigo-600 text-white font-semibold py-3 px-4 rounded-lg hover:bg-indigo-500 disabled:bg-gray-600 disabled:cursor-not-allowed transition duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-gray-900 focus:ring-indigo-500">
          @if (isLoading()) {
            <svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
              <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
              <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
            <span>Parsing Menu...</span>
          } @else {
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
              <path stroke-linecap="round" stroke-linejoin="round" d="M6.827 6.175A2.31 2.31 0 015.186 7.23c-.38.054-.757.112-1.134.174C2.999 7.58 2.25 8.507 2.25 9.574V18a2.25 2.25 0 002.25 2.25h15A2.25 2.25 0 0021.75 18V9.574c0-1.067-.75-1.994-1.802-2.169a47.865 47.865 0 00-1.134-.174 2.31 2.31 0 01-1.64-1.055l-.822-1.316a2.192 2.192 0 00-1.736-1.039 48.776 48.776 0 00-5.232 0 2.192 2.192 0 00-1.736 1.039l-.821 1.316z" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M16.5 12.75a4.5 4.5 0 11-9 0 4.5 4.5 0 019 0zM18.75 10.5h.008v.008h-.008V10.5z" />
            </svg>
            <span>Generate Photos</span>
          }
        </button>
      </div>
    </section>
  </aside>

  <!-- Right Panel: Output Gallery -->
  <main class="lg:col-span-8 xl:col-span-9 bg-gray-800/50 overflow-y-auto">
    <div class="p-6 sm:p-8 lg:p-12">
      @if (error()) {
        <div class="flex flex-col items-center justify-center h-full rounded-lg bg-red-900/20 border border-red-500/30 p-12 text-center">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-12 h-12 text-red-400 mb-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.007H12v-.007z" />
          </svg>
          <h3 class="text-xl font-semibold text-white">An Error Occurred</h3>
          <p class="text-red-300 mt-2">{{ error() }}</p>
        </div>
      }

      @if (dishes().length > 0) {
        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-6">
          @for (dish of dishes(); track dish.dishName + $index) {
            <div class="bg-gray-800 rounded-lg overflow-hidden shadow-lg border border-gray-700/50 flex flex-col">
              <div class="aspect-square w-full bg-gray-700/50">
                @if (dish.isLoading) {
                  <div class="w-full h-full bg-gray-700 animate-pulse-fast"></div>
                } @else if (dish.imageUrl) {
                  <img [src]="dish.imageUrl" [alt]="dish.dishName" class="w-full h-full object-cover">
                } @else if (dish.error) {
                  <div class="w-full h-full flex flex-col items-center justify-center text-center p-4">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10 text-red-400 mb-2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.007H12v-.007z" />
                    </svg>
                    <p class="text-xs text-red-300">{{ dish.error }}</p>
                  </div>
                }
              </div>
              <div class="p-4 flex-grow">
                <h3 class="font-bold text-white">{{ dish.dishName }}</h3>
                <p class="text-sm text-gray-400 mt-1">{{ dish.description }}</p>
              </div>
            </div>
          }
        </div>
      } @else if (!isLoading() && !error()) {
        <div class="flex flex-col items-center justify-center h-full text-center text-gray-500 pt-20">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-20 h-20 mb-4">
            <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 0 0 1.5-1.5V6a1.5 1.5 0 0 0-1.5-1.5H3.75A1.5 1.5 0 0 0 2.25 6v12a1.5 1.5 0 0 0 1.5 1.5Zm10.5-11.25h.008v.008h-.008V8.25Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z" />
          </svg>
          <h2 class="text-2xl font-semibold text-gray-300">Your Gallery Awaits</h2>
          <p class="mt-2 max-w-md">Your generated food photography will appear here. Just paste your menu, pick a style, and click the generate button to begin.</p>
        </div>
      }
    </div>
  </main>

</div>